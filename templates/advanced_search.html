{% extends "base.html" %}
{% block content %}
<h2 class="text-xl font-bold mb-6">상세 조건으로 노트북 검색하기</h2>
<form method="post" action="/search/advanced" class="space-y-6">
  <!-- 예산 슬라이더 -->
  <div>
    <label class="block font-semibold mb-2">예산 범위 (만원)</label>
    <div id="budget_range"></div>
    <input type="hidden" name="budget_range_min">
    <input type="hidden" name="budget_range_max">
    <div>선택: <span id="budget_display"></span> 원</div>
  </div>

  <!-- CPU 점수 슬라이더 -->
  <div>
    <label class="block font-semibold mb-2">CPU PassMark 점수</label>
    <div id="cpu_range"></div>
    <input type="hidden" name="cpu_range_min">
    <input type="hidden" name="cpu_range_max">
    <div>선택: <span id="cpu_display"></span></div>
  </div>

  <!-- GPU 점수 슬라이더 -->
  <div>
    <label class="block font-semibold mb-2">GPU 3DMark 점수</label>
    <div id="gpu_range"></div>
    <input type="hidden" name="gpu_range_min">
    <input type="hidden" name="gpu_range_max">
    <div>선택: <span id="gpu_display"></span></div>
  </div>

  <!-- 디스플레이 크기 슬라이더 -->
  <div>
    <label class="block font-semibold mb-2">디스플레이 크기 (인치)</label>
    <div id="display_range"></div>
    <input type="hidden" name="display_range_min">
    <input type="hidden" name="display_range_max">
    <div>선택: <span id="display_display"></span></div>
  </div>

  <!-- RAM 복수 선택 -->
  <div>
    <label class="block font-semibold mb-2">RAM 용량 (복수 선택)</label>
    <div class="grid grid-cols-4 gap-2">
      <label><input type="checkbox" name="ram" value="8"> 8GB</label>
      <label><input type="checkbox" name="ram" value="16"> 16GB</label>
      <label><input type="checkbox" name="ram" value="32"> 32GB</label>
      <label><input type="checkbox" name="ram" value="64"> 64GB</label>
    </div>
  </div>

  <!-- 저장장치 복수 선택 -->
  <div>
    <label class="block font-semibold mb-2">저장장치 용량 (복수 선택)</label>
    <div class="grid grid-cols-4 gap-2">
      <label><input type="checkbox" name="storage" value="256"> 256GB</label>
      <label><input type="checkbox" name="storage" value="512"> 512GB</label>
      <label><input type="checkbox" name="storage" value="1024"> 1TB</label>
      <label><input type="checkbox" name="storage" value="2048"> 2TB</label>
    </div>
  </div>

  <!-- 해상도 선택 -->
  <div>
    <label class="block font-semibold mb-2">디스플레이 해상도</label>
    <div class="grid grid-cols-3 gap-2">
      <label><input type="checkbox" name="resolution" value="FHD급"> FHD급</label>
      <label><input type="checkbox" name="resolution" value="QHD급"> QHD급</label>
      <label><input type="checkbox" name="resolution" value="UHD급"> UHD급</label>
    </div>
  </div>

  <!-- 편의 기능 -->
  <div>
    <label class="block font-semibold mb-2">편의 기능</label>
    <div class="grid grid-cols-2 gap-2">
      <label><input type="checkbox" name="port_hdmi"> HDMI 포트</label>
      <label><input type="checkbox" name="port_sd"> SD카드 슬롯</label>
      <label><input type="checkbox" name="port_lan"> LAN 포트</label>
      <label><input type="checkbox" name="pd_charge"> PD 충전</label>
      <label><input type="checkbox" name="thunderbolt"> 썬더볼트</label>
    </div>
  </div>

  <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
    조건에 맞는 노트북 보기
  </button>
</form>

<!-- 슬라이더 초기화 스크립트 -->
<link href="https://cdn.jsdelivr.net/npm/nouislider@15.6.0/dist/nouislider.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/nouislider@15.6.0/dist/nouislider.min.js"></script>
<script>
function makeSlider(id, min, max, step, unit, defaultMin, defaultMax) {
  const slider = document.getElementById(id);
  const display = document.getElementById(id.replace('range', 'display'));
  const inputMin = document.querySelector(`input[name='${id}_min']`);
  const inputMax = document.querySelector(`input[name='${id}_max']`);

  noUiSlider.create(slider, {
    start: [defaultMin, defaultMax],
    connect: true,
    step: step,
    range: { min: min, max: max },
    tooltips: [true, true],
    format: {
      to: value => Math.round(value),
      from: value => Number(value)
    }
  });

  slider.noUiSlider.on('update', function (values) {
    inputMin.value = values[0];
    inputMax.value = values[1];
    display.textContent = `${values[0]}${unit} ~ ${values[1]}${unit}`;
  });
}

makeSlider('budget_range', 300000, 2000000, 50000, '원', 500000, 1500000);
makeSlider('cpu_range', 2000, 50000, 1000, '', 8000, 20000);
makeSlider('gpu_range', 1000, 40000, 1000, '', 6000, 16000);
makeSlider('display_range', 11, 17, 0.1, '인치', 13.3, 16);
</script>
{% endblock %}
